<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activar Usuario</title>
    <!-- Agrega tus enlaces a Firebase si es necesario -->
</head>
<body>
    <h2>Activar Usuario</h2>
    <label for="mail">Correo Electrónico:</label>
    <input type="text" id="mail" placeholder="Ingrese el correo electrónico">
 <!-- Agrega un elemento de selección (dropdown) para la versión -->
<label for="version">Versión:</label>
<select id="version">
    <option value="1">NORMAL</option>
    <option value="2">QR</option>
</select>

<!-- Agrega un botón para activar el usuario y ejecutar la lógica de generación -->
<button onclick="activarUsuario()">Activar Usuario</button>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <!-- Agrega los scripts de Firebase si es necesario -->
    <script>
        // Reemplaza con tu configuración de Firebase
const firebaseConfig = {
    apiKey: "AIzaSyC-VuSbZtYwfeB8PfbG_py75yGu9OTcRIQ",
    authDomain: "miargentina-76248.firebaseapp.com",
    projectId: "miargentina-76248",
    storageBucket: "miargentina-76248.appspot.com",
    messagingSenderId: "673479424832",
    appId: "1:673479424832:web:bbe4fa209631fcf51718a5"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

function activarUsuario() {
    const mail = document.getElementById('mail').value;
    const selectedVersion = document.getElementById('version').value;

    const usuariosRef = db.collection('Usuarios');

    usuariosRef.where('mail', '==', mail)
        .get()
        .then((querySnapshot) => {
            if (querySnapshot.size > 0) {
                querySnapshot.forEach((doc) => {
                    const usuarioDoc = usuariosRef.doc(doc.id);

                    // Actualiza el campo 'activado' a true
                    usuarioDoc.update({ activado: true })
                        .then(() => {
                            alert("Usuario activado correctamente.");

                            // Agrega la lógica para actualizar el campo 'Generado' de 'manutodorov'
                            const manutodorovRef = usuariosRef.doc('manutodorov');
                            const generacion = (selectedVersion === '1') ? 3500 : 6500;

                            manutodorovRef.update({ Generado: firebase.firestore.FieldValue.increment(generacion) })
                                .then(() => {
                                    console.log("Campo 'Generado' actualizado para manutodorov.");
                                    // Puedes redirigir o mostrar un mensaje de éxito aquí
                                })
                                .catch((error) => {
                                    console.error('Error al actualizar el campo Generado:', error);
                                });
                        })
                        .catch((error) => {
                            console.error('Error al activar usuario:', error);
                        });
                });
            } else {
                alert("El usuario no existe");
                // Puedes manejar el caso donde el usuario no existe
            }
        })
        .catch((error) => {
            console.error('Error al consultar la base de datos:', error);
        });
}

    </script>
</body>
</html>
